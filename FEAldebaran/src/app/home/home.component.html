<div class="home"> 

  
<div *ngIf="isLoading && !errorFetch" class="loader"> </div>

<div *ngIf="filteringData" class="loader"> </div>

<div *ngIf="errorFetch" class="errorFetch"> <p> SERVER ERROR: An Error has occured when fetch meteors. Try Again <button class="refresh" (click)="refresh()">REFRESH</button> </p></div>

<div *ngIf="errorLogin" class="overlay"> <p style="color:red; padding-left:30%; padding-top: 20%"> ERROR LOGIN <button style="margin-right: 20%; "   class="refresh" (click)="close()">CLOSE</button> </p></div>

<div *ngIf="!fetchSecondPart" style="height:90px">  </div>

<div *ngIf="!isLoading && !errorFetch && fetchSecondPart">  

<div class="buttons_container" style="padding-top: 90px"> 

  <div style="display: flex; align-items:center"> 
<button class="filter_button" style="margin-right:0" (click)="sortMeteors('v_inf')"> Velocity {{fields["v_inf"]== "none" ? "" : fields["v_inf"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('velocity')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<button class="filter_button" style="margin-right:0" (click)="sortMeteors('diameter')"> Diameter {{fields["diameter"]== "none" ? "" : fields["diameter"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('diameter')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<button class="filter_button" style="margin-right:0" (click)="sortMeteors('ps_max')"> Hazard {{fields["ps_max"]== "none" ? "" : fields["ps_max"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('hazard')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<button class="filter_button" style="margin-right:0" (click)="sortMeteors('h')"> Magnitude {{fields["h"]== "none" ? "" : fields["h"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('magnitude')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<button class="filter_button" style="margin-right:0" (click)="sortMeteors('last_obs')"> Last Obs{{fields["last_obs"]== "none" ? "" : fields["last_obs"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('last_obs')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<button class="filter_button" style="margin-right:0" (click)="sortMeteors('range')"> Range {{fields["range"]== "none" ? "" : fields["range"]== "asc" ? "↓" : "↑"}} </button>

<button (click)="showFilterSlider('range')" style="margin-left:0; height:53px; cursor: pointer;margin-right:10px">⋮</button>

<div style="display: inline; font-size:40px; color:white; margin-left:40px; background-color: black; height: 40px; padding-top:25px; padding-left:10px; padding-right:10px; border-radius:10px"> FILTER FOR: </div>

<button class="filter_button" (click)="filterMeteors('CNEOS')" [ngClass]="{'activeFilter': this.CNEOSFilterActive}"> CNEOS  </button>

<button class="filter_button" (click)="filterMeteors('GMN')" [ngClass]="{'activeFilter': this.GMNFilterActive}"> GMN  </button>

<button class="filter_button" (click)="filterMeteors('NASA')" [ngClass]="{'activeFilter': this.NASAFilterActive}"> NASA  </button>

</div>

<div *ngIf="filteringVelocity" class="slider"> 
  <div style="display: inline"> Velocity (km/s)</div>
  <button (click)="undoFiltering('velocity')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
<ngx-slider [(value)]="valueVelocity" [(highValue)]="highValueVelocity"  (valueChange)="minimumMax()" [options]="optionsVelocity"> Velocity</ngx-slider>
<button (click)= "confirmFilter('velocity')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
</div>

<div *ngIf="filteringDiameter" class="slider"> 
  <div style="display: inline"> Diameter (km)</div>
  <button (click)="undoFiltering('diameter')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
  <ngx-slider [(value)]="valueDiameter" [(highValue)]="highValueDiameter"   [options]="optionsDiameter"> Diameter</ngx-slider>
  <button (click)= "confirmFilter('diameter')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
  </div>

  <div *ngIf="filteringHazard" class="slider"> 
    <div style="display: inline"> Hazard (h)</div>
    <button (click)="undoFiltering('hazard')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
    <ngx-slider [(value)]="valueHazard" [(highValue)]="highValueHazard"   [options]="optionsHazard"> Hazard</ngx-slider>
    <button (click)= "confirmFilter('hazard')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
    </div>

    <div *ngIf="filteringMagnitude" class="slider"> 
      <div style="display: inline"> Magnitude (M)</div>
      <button (click)="undoFiltering('magnitude')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
      <ngx-slider [(value)]="valueMagnitude" [(highValue)]="highValueMagnitude"   [options]="optionsMagnitude"> Magnitude</ngx-slider>
      <button (click)= "confirmFilter('magnitude')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
      </div>

      <div *ngIf="filteringLastObs" class="slider"> 
        <div style="display: inline"> Last Obs</div>
        <button (click)="undoFiltering('last_obs')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
        <ngx-slider [(value)]="valueLastObs" [(highValue)]="highValueLastObs"   [options]="optionsLastObs"> Last Observation</ngx-slider>
        <button (click)= "confirmFilter('last_obs')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
        </div>
   
        <div *ngIf="filteringRange" class="slider"> 
          <div style="display: inline"> Range</div>
          <button (click)="undoFiltering('range')" style="display:inline-block; margin-left:90%; background-color:red; cursor:pointer;color:white">    X   </button>
          <ngx-slider [(value)]="valueRange" [(highValue)]="highValueRange"   [options]="optionsRange"> Range</ngx-slider>
          <button (click)= "confirmFilter('range')" style="background-color: green; color: white; cursor:pointer"> FILTER</button>
          </div>


<!-- <button class="filter_button" (click)="switchLoading()">  LOAD</button> -->

<div class="paginate">  

<div *ngIf="page!=1000" (click)="firstPage()"> <button class="paginate_button"> FIRST  </button></div>


<div *ngIf="page>1000" style="display: inline">   <button class="paginate_button" (click)="prevPage()">  PREV </button>  </div>



<div class="page"> {{page/1000}}/{{lastNumberPage}}</div>


<div  *ngIf="page!=lastNumberPage*1000"> <button class="paginate_button" (click)="nextPage()" >   NEXT </button> </div>

<div *ngIf="page!=lastNumberPage*1000" (click)="lastPage()"> <button class="paginate_button"> LAST  </button></div>



<div style="display: inline; position: absolute; right:200px; display: flex; justify-content: space-evenly;">

  <div *ngIf="activeFilterVelocity" style="background-color: rgb(142, 228, 142); padding:10px"> 
    <button (click)="resetFilter('velocity')" style="background-color: red; color: white"> X</button>
    <div> Velocity(km/s): {{fixedValueVelocity}} - {{fixedHighValueVelocity}} </div>
  </div>


  <div *ngIf="activeFilterDiameter" style="background-color: rgb(142, 228, 142); padding:10px; margin-left:20px" > 
    <button (click)="resetFilter('diameter')" style="background-color: red; color: white"> X</button>
    <div> Diameter(km): {{fixedValueDiameter}} - {{fixedHighValueDiameter}} </div>
  </div>

  <div *ngIf="activeFilterHazard" style="background-color: rgb(142, 228, 142); padding:10px; margin-left:20px" > 
    <button (click)="resetFilter('hazard')" style="background-color: red; color: white"> X</button>
    <div> Hazard(h): {{fixedValueHazard}} - {{fixedHighValueHazard}} </div>
  </div>

  <div *ngIf="activeFilterMagnitude" style="background-color: rgb(142, 228, 142); padding:10px; margin-left:20px" > 
    <button (click)="resetFilter('magnitude')" style="background-color: red; color: white"> X</button>
    <div> Magnitude(M): {{fixedValueMagnitude}} - {{fixedHighValueMagnitude}} </div>
  </div>

  <div *ngIf="activeFilterLastObs" style="background-color: rgb(142, 228, 142); padding:10px; margin-left:20px" > 
    <button (click)="resetFilter('last_obs')" style="background-color: red; color: white"> X</button>
    <div> Last Observation: {{fixedValueLastObs}} - {{fixedHighValueLastObs}} </div>
  </div>

  <div *ngIf="activeFilterRange" style="background-color: rgb(142, 228, 142); padding:10px; margin-left:20px" > 
    <button (click)="resetFilter('range')" style="background-color: red; color: white"> X</button>
    <div> Range: {{fixedValueRange}} - {{fixedHighValueRange}} </div>
  </div>

</div>



</div>
<!-- PAGINATE DIV -->





</div>
<!-- MASTER CONTAINER DIV -->


</div> <!-- FINE NG IF-->




<!--GRAPHICS-->
<div class="charts" *ngIf="!filteringData"> 

<div class="pie" [chart]="chartVelocity"> 


</div>
<div class="pie" [chart]="chartDiameter"> 


</div>
<div class="pie" [chart]="chartHazard"> 


</div>

<div class="pie" [chart]="chartRange"> 


</div>

</div>





<div *ngIf="states.alertWindow">  
<div class="overlay"> </div>
<div class="alert"> <h2> YOU ARE NOT APPROVED! WAIT FOR APPROVAL! </h2><button (click)="closeWindow()"> OK</button> </div>


</div>



<div *ngIf="tuttidettaglimeteora"   style="position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background-color: rgba(0,0,0,0.5);
z-index:4;
backdrop-filter: blur(2px);"> 
<div style="width:330px;border: 2px solid red; background-color: white; border-radius:30px; margin-top: 90px; margin-left: 50%; transform: translate(-50%,0); padding-left: 120px; padding-bottom: 20px; padding-right:30px"> 
<button class="close" style="width:50px; margin-top:10px; margin-right:10px" (click)="closeDettagliMeteora()">  X </button>
                             <div style=" border-radius:10px; "> <p style="font-size:20px; font-weight: bold;"> FULL DETAILS METEOR </p>
                                          <div *ngFor="let p of meteoradamostraredettagli|keyvalue" style="margin-bottom: 5px; font-size:20px"> 
                                                 <div *ngIf="p.key!='author'">  {{p.key}}: {{p.value}} </div> 
                                          </div>
                              </div>
 </div>
 </div>




<!-- OLD ADD METEOR -->
 <!-- <div *ngIf="this.states.formAddMeteor" > FORM ADD METREOR </div> -->

<div *ngIf="!isLoading && !errorFetch" class="container_meteors" > 



<div *ngFor="let meteor of selected_meteors" > 
  <app-meteor [meteor]="meteor" (click)="provaAccordion(meteor)"> </app-meteor> 
  <div class="panel"> <div *ngFor="let p of meteor|keyvalue"> INFO NASCOSTE{{p.key}} {{p.value}} </div></div>   
</div>

</div>


<br><br> 













<!-- second old form for add meteor
<div *ngIf="states.formAddMeteor"> 
    <app-create-meteor></app-create-meteor>
</div> -->












<!-- form for add meteor-->
<div class="form-meteor" *ngIf="states.formAddMeteor" > 

  <form [formGroup]="rformMeteor">  

    <button class="close" (click)="closeMeteorForm()"> X</button>
  <div class="title-form-meteor">  <p> ADD METEOR</p> </div> 
    <div class="fields-meteor"> <!-- BEGIN ALL FIELDS DIV -->
  

      <div class="example-container">
      <div class="title-field"> ID Meteor: </div>
          <mat-form-field >
            <mat-label>ID Meteor</mat-label>
            <input matInput placeholder="ID Meteor" formControlName="id"/>
            
          </mat-form-field>
        </div>
        

        

      <div class="example-container" > <!-- THER WAS DISPLAY:GRIDF-->
        <div class="title-field"> Diameter: </div>
<mat-form-field>
  <mat-label>Diameter </mat-label>
  <input matInput placeholder="" formControlName="diameter"/>
</mat-form-field>
</div>

<div class="example-container" >
<div class="title-field"> Magnitude: </div>
<mat-form-field>
  <mat-label>Magnitude </mat-label>
  <input matInput placeholder="" formControlName="h"/>
</mat-form-field>
</div>


<div class="example-container" >
<div class="title-field"> Last Observation: </div>
<mat-form-field>
  <mat-label>Last Observation </mat-label>
  <input matInput placeholder="" formControlName="last_obs"/>
</mat-form-field>
</div>

<div class="example-container" >
<div class="title-field"> Range:</div>
<mat-form-field>
  <mat-label>Range </mat-label>
  <input matInput placeholder="" formControlName="range"/>
</mat-form-field>
</div>


<div class="example-container" >
<div class="title-field"> Hazard: </div>
<mat-form-field>
  <mat-label>Hazard </mat-label>
  <input matInput placeholder="" formControlName="ps_max"/>
</mat-form-field>
</div>

<div class="example-container" >
  <div class="title-field"> Velocity: </div>
<mat-form-field>
  <mat-label>Velocity</mat-label>
  <input matInput placeholder="" formControlName="v_inf"/>
  
</mat-form-field>
</div>



</div> <!-- CLOSE ALL FIELDS DIV -->


  <button class="addMeteor" (click)="sendMeteor()"> ADD</button>
  </form>

</div>











<!-- END FORM FOR ADD EMTEOR-->













<!-- FORM SIGNUP AND LOGIN -->
<div style="
  padding: 10px 10px;
  position: absolute;
  top:0%;
  left:38%;
  z-index:1;
  border: 10px solid white;
  border-radius: 20px;
  width: 20%;
  height: 510px;
  background-color:rgb(43, 39, 39);
  margin-top: 90px
" *ngIf="states.signup" > 

    <form [formGroup]="rform">  

      <button class="close" (click)="close()"> X</button>
    <div class="title-form">  <p> {{states.login ? "LOGIN" : "SIGNUP" }}</p> </div> 
      <div class="fields"> <!-- BEGIN ALL FIELDS DIV -->
    

        <div class="example-container">
         
            <mat-form-field>
              <mat-label>Enter your name</mat-label>
              <input matInput placeholder="name" formControlName="name"/>
              
            </mat-form-field>
          </div>
          

          

        <div class="example-container">
  <mat-form-field>
    <mat-label>Enter your email</mat-label>
    <input matInput placeholder="pat@example.com" formControlName="email"/>
    
  </mat-form-field>
</div>




      <mat-form-field>
    <mat-label>Enter your password</mat-label>
    <input matInput [type]="hide ? 'password' : 'text'" placeholder="$pwd1234" formControlName="password">
    <button mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
      <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
    </button>
  </mat-form-field>

</div> <!-- CLOSE ALL FIELDS DIV -->


    <button class="send" (click)="sendForm()"> SEND</button>
    </form>

</div>


<!-- <button (click)="show()" style="font-size:300px">  show </button> -->
















</div>